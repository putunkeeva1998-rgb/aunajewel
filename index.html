<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AUNA jewel</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.prod.js"></script>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://mapgl.2gis.com/api/js/v1"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --accent: #2c2c2c;
            --gold: #d4af37;
            --bg: #ffffff;
            --card-bg: #f9f9f9;
            --text: #1a1a1a;
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Montserrat', sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
        }

        /* –®–∞–ø–∫–∞ */
        .header {
            padding: 15px;
            text-align: center;
            border-bottom: 1px solid #eee;
            position: sticky; top: 0; background: white; z-index: 100;
        }
        .header h1 { margin: 0; font-size: 18px; letter-spacing: 2px; text-transform: uppercase; }

        /* –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ */
        .categories {
            display: flex; gap: 10px; padding: 10px; overflow-x: auto; white-space: nowrap;
        }
        .cat-btn {
            padding: 8px 20px; border-radius: 20px; border: 1px solid #eee; background: white;
            font-size: 12px; cursor: pointer;
        }
        .cat-btn.active { background: var(--accent); color: white; border-color: var(--accent); }

        /* –°–µ—Ç–∫–∞ —Ç–æ–≤–∞—Ä–æ–≤ */
        .products-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 10px;
            padding-bottom: 100px;
        }
        .card {
            background: var(--card-bg); border-radius: 15px; overflow: hidden; position: relative;
        }
        .card img { width: 100%; height: 180px; object-fit: cover; }
        .card-info { padding: 10px; font-size: 13px; }
        .price { font-weight: 700; margin-top: 5px; }

        /* –¢–∞–±-–±–∞—Ä */
        .tabs {
            position: fixed; bottom: 0; width: 100%; height: 70px;
            background: white; display: flex; justify-content: space-around;
            align-items: center; border-top: 1px solid #eee; z-index: 1000;
        }
        .tab-item { display: flex; flex-direction: column; align-items: center; font-size: 10px; color: #999; }
        .tab-item.active { color: var(--accent); font-weight: 600; }

        /* –ë—É—Ä–≥–µ—Ä */
        .burger-overlay {
            position: fixed; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.5); z-index: 2000;
        }
        .burger-menu {
            position: absolute; left:0; top:0; width:80%; height:100%; background:white;
            padding: 40px 20px;
        }

        /* –î–µ—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞ */
        .full-view {
            position: fixed; top:0; left:0; width:100%; height:100%; background:white;
            z-index: 3000; overflow-y: auto; padding-bottom: 80px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        .main-btn {
            background: var(--accent); color: white; border: none; padding: 15px;
            width: 100%; border-radius: 10px; font-weight: 600; margin-top: 20px;
        }

        #map { width: 100%; height: 250px; border-radius: 15px; margin-top: 15px; }

        .hidden-label {
            position: absolute; top: 10px; right: 10px; background: red; color: white;
            padding: 2px 8px; border-radius: 5px; font-size: 10px;
        }
    </style>
</head>
<body>

<div id="app">
    <div v-if="showBurger" class="burger-overlay" @click="showBurger = false">
        <div class="burger-menu" @click.stop>
            <h2 @click="showBurger = false">‚úï –ó–∞–∫—Ä—ã—Ç—å</h2>
            <div @click="setInfo('about')">–û –Ω–∞—Å</div>
            <div @click="setInfo('return')">–í–æ–∑–≤—Ä–∞—Ç</div>
            <div @click="setInfo('shipping')">–î–æ—Å—Ç–∞–≤–∫–∞</div>
            <div v-if="infoText" style="margin-top:20px; font-size:14px; color:#666;">
                {{ infoText }}
            </div>
        </div>
    </div>

    <header class="header">
        <div @click="toggleBurger" style="position:absolute; left:20px; font-size:20px;">‚ò∞</div>
        <h1>AUNA jewel</h1>
    </header>

    <div v-if="activeTab === 'catalog'">
        <div class="categories">
            <div v-for="c in ['–í—Å–µ', '–°–µ—Ä—å–≥–∏', '–¶–µ–ø–æ—á–∫–∏']" 
                 :class="['cat-btn', category === c ? 'active' : '']"
                 @click="category = c; vibrate()">{{c}}</div>
        </div>
        
        <div class="products-grid">
            <div v-for="p in filteredProducts" :key="p.id" class="card" @click="openP(p)" v-if="!p.hidden || isAdmin">
                <span v-if="p.hidden" class="hidden-label">–°–ö–†–´–¢</span>
                <img :src="p.images[0]">
                <div class="card-info">
                    <div>{{p.name}}</div>
                    <div class="price">{{p.price}} ‚ÇΩ</div>
                </div>
            </div>
        </div>
    </div>

    <div v-if="activeTab === 'cart'" style="padding: 20px;">
        <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
        <div v-for="item in cart" style="display:flex; gap:10px; margin-bottom:10px;">
            <img :src="item.images[0]" style="width:50px; height:50px; border-radius:10px;">
            <div>{{item.name}} ({{item.size}}) - {{item.price}}‚ÇΩ</div>
        </div>
        
        <div v-if="cart.length > 0">
            <input v-model="form.name" placeholder="–ò–º—è" style="width:100%; padding:10px; margin: 10px 0;">
            <input v-model="form.phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" style="width:100%; padding:10px; margin-bottom: 20px;">
            
            <p>–î–æ—Å—Ç–∞–≤–∫–∞:</p>
            <div style="display:flex; gap:10px;">
                <button v-for="m in ['–°–î–≠–ö', '–ü–æ—á—Ç–∞', '5post']" @click="form.method = m; vibrate()"
                        :style="form.method === m ? 'background:black; color:white' : ''" style="flex:1; padding:10px;">{{m}}</button>
            </div>
            
            <div id="map"></div>
            <button class="main-btn" @click="checkout">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button>
        </div>
        <div v-else>–¢—É—Ç –ø–æ–∫–∞ –ø—É—Å—Ç–æ</div>
    </div>

    <div v-if="activeTab === 'profile'" style="padding: 20px; text-align: center;">
        <button class="main-btn" @click="contactSupport">–ù–∞–ø–∏—Å–∞—Ç—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É</button>
        <button class="main-btn" style="background:#eee; color:black; margin-top:10px;">–ú–æ–∏ –∑–∞–∫–∞–∑—ã</button>
        <button v-if="isAdmin" @click="activeTab = 'admin'" style="margin-top:40px; border:none; background:none; color:red;">–í–æ–π—Ç–∏ –≤ –∞–¥–º–∏–Ω–∫—É</button>
    </div>

    <div v-if="activeTab === 'admin'" style="padding: 20px;">
        <h3>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞–º–∏</h3>
        <div v-for="p in products" style="display:flex; justify-content:space-between; margin-bottom:10px;">
            <span>{{p.name}}</span>
            <button @click="toggleHide(p)">{{ p.hidden ? '–ü–æ–∫–∞–∑–∞—Ç—å' : '–°–∫—Ä—ã—Ç—å' }}</button>
        </div>
        
        <hr>
        <h3>–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–π</h3>
        <input v-model="newItem.name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ">
        <input v-model="newItem.price" placeholder="–¶–µ–Ω–∞">
        <input v-model="newItem.sizes" placeholder="–†–∞–∑–º–µ—Ä—ã (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é)">
        <input type="file" @change="uploadImg">
        <button class="main-btn" @click="saveProduct">–û–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å</button>
    </div>

    <div v-if="viewP" class="full-view">
        <div @click="viewP = null" style="padding:20px; font-size:24px;">‚úï</div>
        <div style="display:flex; overflow-x:auto; height:350px;">
            <img v-for="img in viewP.images" :src="img" style="min-width:100%; object-fit:cover;">
        </div>
        <div style="padding: 20px;">
            <h2>{{viewP.name}}</h2>
            <p>{{viewP.desc || '–ü—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ —É–∫—Ä–∞—à–µ–Ω–∏–µ –¥–ª—è –≤–∞—à–µ–≥–æ –æ–±—Ä–∞–∑–∞.'}}</p>
            <p class="price" style="font-size:20px;">{{viewP.price}} ‚ÇΩ</p>
            
            <p>–í—ã–±–µ—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä:</p>
            <div style="display:flex; gap:10px;">
                <div v-for="s in viewP.sizes" @click="selSize = s; vibrate()"
                     :style="selSize === s ? 'background:black; color:white' : 'border:1px solid #ddd'"
                     style="padding:10px 15px; border-radius:5px;">{{s}}</div>
            </div>
            
            <button class="main-btn" @click="addToCart(viewP)">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
        </div>
    </div>

    <nav class="tabs">
        <div class="tab-item" :class="{active: activeTab === 'catalog'}" @click="activeTab = 'catalog'; vibrate()"><span>üì¶</span>–ö–∞—Ç–∞–ª–æ–≥</div>
        <div class="tab-item" :class="{active: activeTab === 'fav'}" @click="activeTab = 'fav'; vibrate()"><span>‚ù§Ô∏è</span>–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</div>
        <div class="tab-item" :class="{active: activeTab === 'cart'}" @click="activeTab = 'cart'; vibrate()"><span>üõí</span>–ö–æ—Ä–∑–∏–Ω–∞</div>
        <div class="tab-item" :class="{active: activeTab === 'profile'}" @click="activeTab = 'profile'; vibrate()"><span>üë§</span>–ü—Ä–æ—Ñ–∏–ª—å</div>
    </nav>
</div>



<script>
const tg = window.Telegram.WebApp;
const { createApp } = Vue;

createApp({
    data() {
        return {
            activeTab: 'catalog',
            showBurger: false,
            category: '–í—Å–µ',
            viewP: null,
            selSize: null,
            isAdmin: true, // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è —Ç–µ—Å—Ç–∞
            infoText: '',
            form: { name: '', phone: '', method: '–°–î–≠–ö' },
            cart: JSON.parse(localStorage.getItem('auna_cart') || '[]'),
            products: [
                {id: 1, name: '–ö–æ–º–ø–ª–µ–∫—Ç—ã', price: 4500, category: '–ö–æ–º–ø–ª–µ–∫—Ç—ã', images: ['1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '6.jpg'], sizes: ['40—Å–º', '45—Å–º'], hidden: false},
                {id: 2, name: '–¶–µ–ø—å "Gold"', price: 2500, category: '–¶–µ–ø–æ—á–∫–∏', images: ['1.jpg', '2.jpg', '3.jpg', '4.jpg', '5.jpg', '6.jpg', '6.jpg'], sizes: ['40—Å–º', '45—Å–º'], hidden: false}
            ],
            newItem: { name: '', price: '', sizes: '', images: [] }
        }
    },
    computed: {
        filteredProducts() {
            if (this.category === '–í—Å–µ') return this.products;
            return this.products.filter(p => p.category === this.category);
        }
    },
    methods: {
        vibrate() { tg.HapticFeedback.impactOccurred('light'); },
        toggleBurger() { this.vibrate(); this.showBurger = !this.showBurger; },
        openP(p) { this.vibrate(); this.viewP = p; this.selSize = p.sizes[0]; },
        setInfo(type) {
            const info = {
                about: 'AUNA jewel ‚Äî —É–∫—Ä–∞—à–µ–Ω–∏—è —Å –¥—É—à–æ–π.',
                return: '–í–æ–∑–≤—Ä–∞—Ç –≤ —Ç–µ—á–µ–Ω–∏–µ 14 –¥–Ω–µ–π.',
                shipping: '–î–æ—Å—Ç–∞–≤–∫–∞ –ø–æ –≤—Å–µ–º—É –º–∏—Ä—É.'
            };
            this.infoText = info[type];
        },
        addToCart(p) {
            this.vibrate();
            this.cart.push({...p, size: this.selSize});
            localStorage.setItem('auna_cart', JSON.stringify(this.cart));
            this.viewP = null;
            tg.showAlert('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É!');
        },
        async uploadImg(e) {
            const file = e.target.files[0];
            let formData = new FormData();
            formData.append('image', file);
            // –ó–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ –≤–∞—à API –∫–ª—é—á ImgBB
            const res = await fetch('imgbb 839e62907e9a52f0159461b7771bcb2f', {
                method: 'POST',
                body: formData
            });
            const data = await res.json();
            this.newItem.images.push(data.data.url);
        },
        saveProduct() {
            this.products.push({ ...this.newItem, id: Date.now(), hidden: false, sizes: this.newItem.sizes.split(',') });
            this.activeTab = 'catalog';
        },
        toggleHide(p) { p.hidden = !p.hidden; },
        contactSupport() { tg.openTelegramLink('https://t.me/opttania'); },
        checkout() {
            this.vibrate();
            const orderData = `–ó–∞–∫–∞–∑: ${this.cart.map(i => i.name).join(', ')}\n–î–æ—Å—Ç–∞–≤–∫–∞: ${this.form.method}\n–ò–º—è: ${this.form.name}`;
            tg.sendData(orderData); // –û—Ç–ø—Ä–∞–≤–∫–∞ –±–æ—Ç—É
            this.cart = [];
            localStorage.removeItem('auna_cart');
            tg.close();
        }
    },
    mounted() {
        tg.ready();
        tg.expand();
        if (tg.initDataUnsafe.user) {
            this.form.name = tg.initDataUnsafe.user.first_name;
        }
        
        // –ö–∞—Ä—Ç–∞ 2GIS
        setTimeout(() => {
            const map = new mapgl.Map('map', {
                center: [37.6176, 55.7558],
                zoom: 13,
                key: 'cab82c94-e619-42eb-9814-3361712feaf0'
            });
        }, 1000);
    }
}).mount('#app');
</script>
</body>
</html>
